kind: ConfigMap
apiVersion: v1
metadata:
  name: {{ include "base.fullname" . }}
  labels:
    {{- include "base.labels" . | nindent 4 }}
data:
{{- with .Values.envs }}
{{- range $key, $value := .}}
{{- range $subkey, $subvalue := .}}
  {{ $subkey }}: {{ $subvalue }}
{{- end }}
{{- end }}
{{- end }}

{{- if .Values.configuration.files -}}
{{- $files := .Files }}
{{- range .Values.configuration.files }}
  {{ . }}: |
    {{ toJson ($files.Get (printf "configs/%s" .) | quote) }}
{{ end -}}
{{- end -}}
